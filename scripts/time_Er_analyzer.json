{
   "morpho":
   {
     "do_preprocessing": True,
     "do_stan": True,
     "do_postprocessing": False,
     "do_plots": False
   },
"preprocessing":
   {
    "which_preprocessing":[
      {
        "method_name": "data_generator_ricochet",
        "module_name": "data_generator_ricochet",
        "which_spectrum": ["Er","time"],
        "Poisson_redistribution": True,
        "Gaussian_redistribution": True,
        "Gauss_signal_pct_variation": 5,
        "generate_input_time_shape_files" : True,
        "input_file_times" : "./Ricochet/data/times.csv",
        "input_file_rate_shape" : "./Ricochet/data/rates.csv",
        "nBinHistoTime": 5,
        "generate_input_Er_shape_files" : False,
        "input_file_energies" : "./Ricochet/data/recoilEnergies.csv",
        "input_file_diff_rate_shape" : "./Ricochet/data/differentialRates.csv",
        "nBinHistoEr": 100,
        "minEnergy": 100,
        "maxEnergy": 3000,
        "startTime": 0,
        "endTime": 1825,
        "avg_power_frac": 1.0,
        "full_power_time_frac":0.6,
        "signal_rate": 5.0,
        "background_rate": 50,
        "nBackgrounds": 3,
        "background_fracs":[0.27,0.23,0.5],
        "background_halflives_inverse_days":[0,1.0/365.0,1.0/365.0],
        "background_decay_per_keV_inverse":[0,0,0],
        "background_trit_frac":0.27,
        "output_file_rate_shape_binned": "./Ricochet/results/count_generator_reduced.root",
        "output_file_rate_shape_binned_format": "root",
        "output_tree_rate_shape_binned": "rate_shape",
        "output_file_diff_rate_shape_binned": "./Ricochet/results/spectrum_generator_reduced.root",
        "output_file_diff_rate_shape_binned_format": "root",
        "output_tree_diff_rate_shape_binned": "spectrum",
        "output_file_fake_data" : "./Ricochet/results/time_Er_generator_reduced_fake.out",
        "output_file_fake_data_format": "R",
        "additional_file_name" : "./Ricochet/results/time_Er_additionalData.out",
      }
    ]
},
    "stan": {
        
        "name": "time_Er_analyzer",
        
        "model":   {
            "file": "./Ricochet/models/time_Er_analyzer.stan",
            "function_file": [
                              {"name" : "ricochet", "file" : "../functions/ricochet.functions"}
                              ],
            "cache": "./Ricochet/cache"
        },
        
        "data": {
            "type": "mc",
            "files": [
                      {
                      "name": "./Ricochet/results/time_Er_additionalData.out",
                      "format":"R"
                      },
                      {
                      "name" : "./Ricochet/results/spectrum_generator_reduced.root",
                      "format" : "root",
                      "tree" : "spectrum",
                      "branches" : [
                                     {"name" : "energy", "stan_alias" : "energy"},
                                     {"name" : "Er_signal_binned", "stan_alias" : "Er_signal_binned"},
                                    ]
                      },
                      {
                      "name" : "./Ricochet/results/count_generator_reduced.root",
                      "format" : "root",
                      "tree" : "rate_shape",
                      "branches" : [
                                     {"name" : "time", "stan_alias" : "time"},
                                     {"name" : "time_signal_binned", "stan_alias" : "time_signal_binned"},
                                    ]
                      },
                      {
                      "name" : "./Ricochet/results/time_Er_generator_reduced_fake.out",
                      "format" : "R"
                      }
                      ],
            "comment": [
                      {
                      "name" : "./Ricochet/results/time_Er_generator_reduced_fake.root",
                      "format" : "root",
                      "tree" : "spectrum_data",
                      "branches" : [
                                     {"name" : "n_counts_data", "stan_alias" : "n_counts_data", "data_format" : "integer"},
                                    ]
                      }],
            "parameters": [
                           {
                           "minEnergy": 100,
                           "maxEnergy": 3000,
                           "startTime": 0,
                           "endTime": 1825,
                           "signal_lb":0,
                           "signal_ub":50,
                           "background_lb":0,
                           "background_ub":500,
                           "power_variation_pct_lb":0,
                           "power_variation_pct_ub":100
                           }
                           ]
        },
        
        "run": {
            "algorithm": "NUTS",
            "iter": 12000,
            "warmup" : 10000,
            "chain": 6},
        
        
        "sample": "./Ricochet/results/spectrum_analyzer.out",
        
        "output":
        {
            "name" : "./Ricochet/results/time_Er_analyzer",
            "format": "root",
            "tree" : "analysis_parameters",
            "save_cache_name": "./Ricochet/results/cache_name_file.txt", 
            "fit": "./Ricochet/results/analysis_fit.pkl", 
            "branches": [
                 {"variable": "signal_rate","root_alias": "signal_rate"},
                 {"variable": "signal_rate_smeared","root_alias": "signal_rate_smeared"},
                 {"variable": "background_rate","root_alias": "background_rate"},
                 {"variable": "trit_frac","root_alias": "trit_frac"},
                 {"variable": "lp__","root_alias": "lp__"},
                     ]
        }
        
    },

"postprocessing":
  {
    "which_pp":[
      {
      }
   ]
   },

"plot":
    {
      "which_plot":[
        {
        "method_name": "neutrino_params",
        "module_name": "neutrino_params",
        "read_cache_name": "./Ricochet/results/cache_name_file.txt",
        "input_fit_name": "./Ricochet/results/analysis_fit_IH.pkl",
        "output_path": "./Ricochet/results/",
        "output_format": "pdf",
        "plotting_options": ["neutrino_masses", "mass_params", "mixing_params", "contours"],
        "data": {"nu_mass":"nu_mass","sin2_th12":"sin2_th12", "sin2_th13":"sin2_th13", "delta_m21":"delta_m21", "delta_m32":"delta_m32", "m32_withsign":"m32_withsign", "mbeta":"mbeta", "min_mass":"min_mass"},
        "hierarchy": "inverted"
        }
    ]
    }
}
